/* THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
If you want to view the source, please visit the GitHub repository of this plugin. */

"use strict";var c=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var g=Object.prototype.hasOwnProperty;var h=(i,e)=>{for(var t in e)c(i,t,{get:e[t],enumerable:!0})},u=(i,e,t,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of p(e))!g.call(i,s)&&s!==t&&c(i,s,{get:()=>e[s],enumerable:!(a=d(e,s))||a.enumerable});return i};var w=i=>u(c({},"__esModule",{value:!0}),i);var b={};h(b,{default:()=>r});module.exports=w(b);var o=require("obsidian");var n=require("obsidian"),l=class extends n.PluginSettingTab{plugin;constructor(e,t){super(e,t),this.plugin=t}display(){let{containerEl:e}=this;e.empty(),new n.Setting(e).setName("New tab opens\u2026").setDesc("What to open when a new tab is created. (Except for the new tab page, the respective plugin needs to be enabled.)").addDropdown(t=>{t.addOptions({"new-tab-page":"New Tab Page","daily-notes":"Daily Note (Core Plugin)","periodic-notes:open-daily-note":"Daily Note (Periodic Notes Plugin)","periodic-notes:open-weekly-note":"Weekly Note (Periodic Notes Plugin)","periodic-notes:open-monthly-note":"Monthly Note (Periodic Notes Plugin)","random-note":"Random Note (Core Plugin)","switcher:open":"Quick Switcher (Core Plugin)","obsidian-another-quick-switcher:search-command_recent-search":"Another Quick Switcher","darlal-switcher-plus:switcher-plus:open":"Quick Switcher++"}).setValue(this.plugin.settings.whatToOpen).onChange(async a=>{this.plugin.settings.whatToOpen=a,await this.plugin.saveSettings()})}),new n.Setting(e).setName("Default new tab page").setDesc("Path of the note that will be opened in new tabs. Images and PDFs also work. Only takes effect when the setting above is 'New Tab Page'.").addText(t=>t.setPlaceholder("Meta/Homepage.md").setValue(this.plugin.settings.filePath).onChange(async a=>{this.plugin.settings.filePath=a,await this.plugin.saveSettings()})),new n.Setting(e).setName("Mode").setDesc("Select the mode in which the default new tab page will be opened.").addDropdown(t=>{t.addOptions({"obsidian-default":"Obsidian Default","live-preview":"Live Preview","reading-mode":"Reading Mode","source-mode":"Source Mode"}).setValue(this.plugin.settings.mode).onChange(async a=>{this.plugin.settings.mode=a,await this.plugin.saveSettings()})}),new n.Setting(this.containerEl).setName("Compatibility mode").setDesc("Enable compatibility mode for other plugins (e.g. Obsidian Projects) which open new tabs. This introduces minor delays.").addToggle(t=>{t.setValue(this.plugin.settings.compatibilityMode).onChange(async a=>{this.plugin.settings.compatibilityMode=a,await this.plugin.saveSettings()})})}};var m={whatToOpen:"new-tab-page",filePath:"",mode:"obsidian-default",compatibilityMode:!1},r=class extends o.Plugin{settings;async onload(){await this.loadSettings(),this.addSettingTab(new l(this.app,this));let{workspace:e}=this.app;e.onLayoutReady(()=>{let t=new WeakSet;e.iterateAllLeaves(a=>{t.add(a)}),this.registerEvent(e.on("layout-change",()=>{this.checkForNewTab(t)}))}),console.debug("New Tab Default Page Plugin loaded.")}async loadSettings(){this.settings=Object.assign({},m,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}async onunload(){console.debug("New Tab Default Page Plugin unloaded.")}checkForNewTab(e){this.app.workspace.iterateAllLeaves(t=>{e.has(t)||(e.add(t),this.tabIsEmpty(t)&&(this.settings.whatToOpen==="new-tab-page"?this.openDefaultPage(t):this.runCommand(this.settings.whatToOpen,t)))})}runCommand(e,t){let a=e.includes("switcher")?200:0;setTimeout(()=>{if(!this.tabIsEmpty(t))return;this.app.commands.executeCommandById(e)!==!1||new o.Notice("Plugin for the New Tab Page is not enabled.")},a)}tabIsEmpty(e){return!e.view||e.view.getViewType()==="empty"}async leafIsStillEmpty(e){return new Promise((t,a)=>{process.nextTick(()=>{let s=e.getViewState();t(s?.type==="empty")})})}async openDefaultPage(e){let t=this.settings.filePath;if(!t)return;let a=this.app.metadataCache.getFirstLinkpathDest(t,"/");if(!!!a){new o.Notice(`${t} is not a valid path to a note in your vault.`);return}this.settings.compatibilityMode&&!await this.leafIsStillEmpty(e)||(await e.openFile(a),this.setViewMode(e,this.settings.mode))}setViewMode(e,t){let a=e.getViewState();t==="source-mode"?(a.state.mode="source",a.state.source=!0):t==="live-preview"?(a.state.mode="source",a.state.source=!1):t==="reading-mode"&&(a.state.mode="preview"),e.setViewState(a)}};

/* nosourcemap */